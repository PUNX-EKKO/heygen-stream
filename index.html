<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>HeyGen Live Stream</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 30px;
      background-color: #f0f0f0;
    }
    video {
      width: 80%;
      max-width: 800px;
      border: 2px solid #333;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <h1>HeyGen Live Stream</h1>
  <video id="video" autoplay playsinline></video>

  <!-- LiveKit Client SDK from CDN -->
  <script src="https://unpkg.com/@livekit/client/dist/livekit-client.min.js"></script>
  <script>
    // Replace this with the actual HeyGen API response data
    const heygenData = {
      session_id: "f8b0671c-315a-11f0-b6bf-223772d1bcc4",
      access_token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3NDczNzkxMjQsImlzcyI6IkFQSUplMjZaamg4YUFYRCIsIm5iZiI6MTc0NzI5MjcyNCwic3ViIjoiY2xpZW50IiwidmlkZW8iOnsiY2FuUHVibGlzaCI6dHJ1ZSwiY2FuUHVibGlzaERhdGEiOnRydWUsImNhblN1YnNjcmliZSI6dHJ1ZSwiY2FuVXBkYXRlT3duTWV0YWRhdGEiOmZhbHNlLCJyb29tIjoiZjhiMDY3MWMtMzE1YS0xMWYwLWI2YmYtMjIzNzcyZDFiY2M0Iiwicm9vbUpvaW4iOnRydWV9fQ.cnlhLm-ZV9yAReNmdbkb2cLR9hC34Q_dmmlMhAiFUXo",
      url: "wss://heygen-feapbkvq.livekit.cloud"
    };

    async function startStream() {
      const { Room } = window.livekit;
      const room = new Room();

      try {
        await room.connect(heygenData.url, heygenData.access_token);
        console.log('Connected to LiveKit');

        // Attach remote video track
        room.on('trackSubscribed', (track, publication, participant) => {
          if (track.kind === 'video') {
            const videoEl = document.getElementById('video');
            track.attach(videoEl);
          }
        });

        room.on('trackUnsubscribed', (track) => {
          if (track.kind === 'video') {
            track.detach().forEach(el => el.remove());
          }
        });

      } catch (error) {
        console.error('Connection error:', error);
        alert('Failed to connect to stream');
      }
    }

    startStream();
  </script>
</body>
</html>
